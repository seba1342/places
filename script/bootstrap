#!/usr/bin/env bash
set -e

echo "🚀 Bootstrapping Places app..."

# Install dependencies
echo "📦 Installing dependencies..."
yarn install

# Start database
echo "🐘 Starting PostgreSQL..."
docker-compose up -d

# Wait for database to be ready
echo "⏳ Waiting for database to be ready..."
sleep 3

# Run migrations
echo "🔄 Running database migrations..."
cd backend && npx prisma migrate dev --name init
echo "✅ Migrations complete"

# Seed database
echo "🌱 Seeding database with Melbourne places..."
npx prisma db seed
echo "✅ Database seeded"

cd ..

echo ""
echo "✨ Bootstrap complete! Run './start' to launch the app."
