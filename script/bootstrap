#!/usr/bin/env bash
set -e

echo "ğŸš€ Bootstrapping Places app..."

# Install dependencies
echo "ğŸ“¦ Installing dependencies..."
yarn install

# Start database
echo "ğŸ˜ Starting PostgreSQL..."
docker-compose up -d

# Wait for database to be ready
echo "â³ Waiting for database to be ready..."
sleep 3

# Run migrations
echo "ğŸ”„ Running database migrations..."
cd backend && npx prisma migrate dev --name init
echo "âœ… Migrations complete"

# Seed database
echo "ğŸŒ± Seeding database with Melbourne places..."
npx prisma db seed
echo "âœ… Database seeded"

cd ..

echo ""
echo "âœ¨ Bootstrap complete! Run './start' to launch the app."
